{"version":3,"sources":["utils/i18n.ts","item-type-changer.ts","main.tsx"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"../src","sourcesContent":["export const i18n = (key) => {\n  return game.i18n.localize(key);\n};\n","import { i18n } from \"./utils/i18n\";\n\nconst itemTypes = [\n  \"weapon\",\n  \"equipment\",\n  \"consumable\",\n  \"tool\",\n  \"backpack\",\n  \"loot\",\n];\n\nconst displayNames = {\n  weapon: \"Weapon\",\n  equipment: \"Equipment\",\n  consumable: \"Consumable\",\n  tool: \"Tool\",\n  backpack: \"Container\",\n  loot: \"Loot\",\n};\n\nconst faIcons = {\n  weapon: \"fist-raised\",\n  equipment: \"tshirt\",\n  consumable: \"bomb\",\n  tool: \"tools\",\n  backpack: \"suitcase\",\n  loot: \"gem\",\n};\n\nconst closeDropdown = ($dropDown) => {\n  $dropDown.removeClass(\"is-open\");\n  $dropDown.css({ maxHeight: 0, paddingTop: 0, paddingBottom: 0 });\n  setTimeout(() => {\n    if (!$dropDown.hasClass(\"is-open\")) {\n      $dropDown.offset({ top: 0, left: 0 });\n    }\n  }, 300);\n};\n\nexport const initItemChanger = () => {\n  Hooks.on(\"renderItemSheet\", (app, html, data) => {\n    const openBtn = $(`<a\n        class=\"open-changer-dropdown\"\n        title=\"Open Change Dropdown\">\n        <i class=\"fas fa-random\"></i>\n        ${i18n(\"5eItemChanger.ui.handle\")}\n      </a>`);\n    openBtn.on(\"click\", function () {\n      const $openBtn = $(this);\n      const $container = $openBtn.parent(\".changer-container\");\n      const $dropDown = $container.children(\".dropdown-body\");\n\n      if ($dropDown.hasClass(\"is-open\")) {\n        closeDropdown($dropDown);\n        return;\n      }\n\n      const containerOffset = $container.offset();\n      const containerHeight = $container.height();\n      const dropdownOffsetTop = containerOffset.top + containerHeight / 2 + 15;\n      $dropDown.addClass(\"is-open\");\n      $dropDown.offset({ top: dropdownOffsetTop, left: containerOffset.left });\n      $dropDown.css({ maxHeight: 400, paddingTop: 8, paddingBottom: 8 });\n    });\n    const container = $(\n      '<div class=\"changer-container\" style=\"max-width:104px;\"><style type=\"text/css\">.changer-button:hover{background: rgba(0,0,0,1) !important;}</style></div>'\n    );\n    const dropdownBody = $('<div class=\"dropdown-body\"></div>');\n    dropdownBody.css({\n      position: \"fixed\",\n      zIndex: 1000,\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"flex-start\",\n      width: 200,\n      maxHeight: 0,\n      transition: \"max-height .3s, padding-top .3s, padding-bottom .3s\",\n      background: \"rgba(0,0,0,0.55)\",\n      border: \"solid 1px rgba(0,0,0,0.8)\",\n      overflow: \"hidden\",\n    });\n    const changerButtons = itemTypes.map((type) => {\n      const button = $(\n        `<div\n          class=\"changer-button\"\n          data-type=\"${type}\">\n          <span>${displayNames[type]}</span>\n          <div style=\"display:flex; height: 100%; width: 32px; align-items: center; justify-content: center;\">\n            <i class=\"fas fa-${faIcons[type]}\"></i>\n          </div>\n        </div>`\n      );\n      button.css({\n        width: \"100%\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        color: \"white\",\n        padding: \"2px 8px\",\n        cursor: \"pointer\",\n        background: \"transparent\",\n        transition: \"background .3s\",\n      });\n      button.on(\"click\", function () {\n        const $button = $(this);\n        const newType = $button.attr(\"data-type\");\n        const $dropDown = $button.parents(\".dropdown-body\");\n        const $itemWindow = $button.parents(\".app.window-app.dnd5e.sheet.item\");\n        const id = $itemWindow.attr(\"id\");\n        if (!id) throw Error(\"id on item window not found\");\n        const itemId = id.split(\"item-\")[1];\n        const actorId = id.split(\"actor-\")[1].split(\"-item\")[0];\n        if (!itemId) throw Error(`no item ID found: ${id}`);\n        const actor = game.actors.get(actorId, {});\n        const item = actor.items.filter(\n          (item) => item.data._id === itemId\n        )[0] as Item;\n        if (!item) throw Error(`no item with id ${itemId} found`);\n        const newData = { type: newType } as any;\n        if (newType === \"equipment\") {\n          newData.data = { armor: { type: \"clothing\", value: 10 } };\n        }\n        if (newType === \"weapon\") {\n          newData.data = {\n            properties: {\n              fin: false,\n              lgt: false,\n              thr: false,\n              amm: false,\n              hvy: false,\n              fir: false,\n              foc: false,\n              lod: false,\n              rch: false,\n              rel: false,\n              ret: false,\n              spc: false,\n              two: false,\n              ver: false,\n            },\n          };\n        }\n        item.update(newData, {});\n        // item.data.type = newType;\n\n        closeDropdown($dropDown);\n      });\n      return button;\n    });\n    container.append(openBtn);\n    for (const button of changerButtons) {\n      dropdownBody.append(button);\n    }\n    container.append(dropdownBody);\n    html.closest(\".app\").find(\".changer-container\").remove();\n    let titleElement = html\n      .closest(\".app.dnd5e.sheet.item\")\n      .find(\".window-title\");\n    container.insertAfter(titleElement);\n  });\n};\n","import { initItemChanger } from \"./item-type-changer\";\n\ninitItemChanger();\n"]}